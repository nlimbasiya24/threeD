import*as o from"https://cdn.jsdelivr.net/gh/nlimbasiya24/threeD/three.module.min.js";import{TTFLoader as r}from"https://cdn.jsdelivr.net/gh/nlimbasiya24/threeD/TTFLoader.min.js";import{OrbitControls as e}from"https://cdn.jsdelivr.net/gh/nlimbasiya24/threeD/OrbitControls.min.js";import{FlakesTexture as s}from"https://cdn.jsdelivr.net/gh/nlimbasiya24/threeD/FlakesTexture.min.js";import{RGBELoader as n}from"https://cdn.jsdelivr.net/gh/nlimbasiya24/threeD/RGBELoader.min.js";jQuery("#three-d-prv").click(function(){console.log("button clicked"),jQuery("#prs-colors").t(Q),jQuery("#personalized-preview").i("prv-initialized")?(jQuery("#personalized-preview").o(),setTimeout(function(){$("#infiniteoptions-container").find("input[type=text]").length&&(""!=$("#infiniteoptions-container").find("input[type=text]").l()&&(h=$("#infiniteoptions-container").find("input[type=text]").l()),E())},1e3)):jQuery("#personalized-preview").o(function(){D(),setTimeout(function(){$("#infiniteoptions-container").find("input[type=text]").length&&(""!=$("#infiniteoptions-container").find("input[type=text]").l()&&(h=$("#infiniteoptions-container").find("input[type=text]").l()),E())},1e3)})});let a,t,l,c,p,u,C,G,d,i,O,m,v,f,w,y,j=!0,h="3D Preview",g=window.p;""!=g.u&&(h=g.u),_3dSettings.m.includes("uppercase")?h=h.toUpperCase():_3dSettings.m.includes("lowercase")?h=h.toLowerCase():_3dSettings.m.includes("capitalize")&&(h=(h=h.toLowerCase()).charAt(0).toUpperCase()+h.slice(1));let Q="";g.v.length&&g.v.forEach(function(e,n){Q+=0==n?'<li class="active" data-color="'+e+'" style="background: '+e+'"></li>':'<li data-color="'+e+'" style="background: '+e+'"></li>'}),console.log(Q);let q=20,A=70,P=0,H=12,I=2,J=1.5,z=null,K=!1,b=0,S=0,x=0,T=0,k=window.innerWidth/2;function D(){a=new o.j,(u=document.createElement("div")).setAttribute("id","junaid-prs-canvas"),jQuery("#personalized-preview").append(u),jQuery("#personalized-preview").h("prv-initialized"),(l=new o.$({alpha:!0,antialias:!0})).g($(u).width(),$(u).height()),u.appendChild(l.S),l.T=o.k,l.D=o.F,l._=1.25,(t=new o.L(70,$(u).width()/$(u).height(),1,1e3)).position.set(0,150,500),(c=new e(t,l.S)).M=!0,c.R=.5,c.B=!0,(p=new o.C(14334036,1)).position.set(200,200,200),a.add(p);let i=new o.G(l);(new n).load(g.images.q.current.O,function(e){w=i.A(e),(y=new o.H(new s)).P=o.I,y.J=o.I,y.repeat.x=10,y.repeat.y=6,d=new o.K,a.add(d);let n=new r;var t=selectedFont[0].O;n.load(t,function(e){z=new o.N(e),F()}),_()}),u.style.touchAction="none",u.addEventListener("pointerdown",M),window.addEventListener("resize",L),jQuery("#prs-colors li").click(function(){jQuery("#prs-colors li").U("active"),jQuery(this).h("active"),E(jQuery(this).V("data-color"))}),jQuery("#prv-update").click(function(){let e=jQuery("#prs-text-input").l();""!=e&&(_3dSettings.m.includes("uppercase")?e=e.toUpperCase():_3dSettings.m.includes("lowercase")?e=e.toLowerCase():_3dSettings.m.includes("capitalize")&&(e=(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)),h=e,E())})}function F(e){void 0===e&&(e=jQuery("#prs-colors li.active").V("data-color")),f={W:1,X:.01,Y:1,Z:.2,color:e,ee:y,ne:new o.te(.15,.15),ie:w.oe},v=new o.re(f),(m=new o.ae(h,{font:z,size:70,height:20,le:12,ce:2,pe:1.5,ue:!0})).se(),m.de();let n=-.5*(m.me.max.x-m.me.min.x);(i=new o.ve(m,v)).position.x=n,i.position.y=0,i.position.z=0,i.rotation.x=0,i.rotation.y=2*Math.PI,d.add(i)}function _(){c.update(),l.fe(a,t),requestAnimationFrame(_)}function L(){k=$(u).width()/2,t.we=$(u).width()/$(u).height(),t.ye(),l.g($(u).width(),$(u).height())}function N(e){j&&(j=!1,h="");let n=e.keyCode;if(8===n)return e.preventDefault(),h=h.substring(0,h.length-1),E(),!1;{let e=String.fromCharCode(n);h+=e,E()}}function U(e){let n=e.which;if(8===n)e.preventDefault();else{let e=String.fromCharCode(n);h+=e,E()}}function E(e){try{d.remove(i)}catch(e){console.log(e)}h&&F(e)}function M(e){!1!==e.isPrimary&&(T=e.clientX-k,S=b,document.addEventListener("pointermove",R),document.addEventListener("pointerup",B))}function R(e){!1!==e.isPrimary&&(b=S+.02*((x=e.clientX-k)-T))}function B(){!1!==event.isPrimary&&(document.removeEventListener("pointermove",R),document.removeEventListener("pointerup",B))}jQuery("#prs-close").click(function(){jQuery("#personalized-preview").je(),jQuery("#junaid-prs-canvas").remove(),jQuery("#personalized-preview").U("prv-initialized")});
